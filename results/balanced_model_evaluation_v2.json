{
  "model": "models/bit_xgboost_balanced_v2.json",
  "threshold": 0.2501371204853058,
  "date": "2025-12-14 22:49:57",
  "training_info": {
    "safe_benign": 2068,
    "benign_with_triggers": 363,
    "total_benign": 1225,
    "malicious": 1225,
    "total": 2450,
    "train_size": 1960,
    "val_size": 490,
    "class_balance": 0.5
  },
  "datasets": {
    "SaTML": {
      "dataset": "SaTML",
      "preprocessed": false,
      "samples": 5000,
      "single_class": "malicious",
      "recall": 0.0,
      "tp": 0,
      "fn": 0,
      "accuracy": 0.0,
      "duration_ms": 9951.221942901611,
      "threshold": 0.2501371204853058
    },
    "deepset_benign": {
      "dataset": "deepset_benign",
      "preprocessed": false,
      "samples": 343,
      "single_class": "benign",
      "fpr": 0.0,
      "fp": 0,
      "tn": 0,
      "accuracy": 0.0,
      "duration_ms": 257.95888900756836,
      "threshold": 0.2501371204853058
    },
    "deepset_injections": {
      "dataset": "deepset_injections",
      "preprocessed": false,
      "samples": 203,
      "single_class": "malicious",
      "recall": 0.0,
      "tp": 0,
      "fn": 0,
      "accuracy": 0.0,
      "duration_ms": 416.2740707397461,
      "threshold": 0.2501371204853058
    },
    "NotInject": {
      "dataset": "NotInject",
      "error": "No samples after filtering"
    },
    "LLMail": {
      "dataset": "LLMail",
      "preprocessed": false,
      "samples": 5000,
      "single_class": "malicious",
      "recall": 0.0,
      "tp": 0,
      "fn": 0,
      "accuracy": 0.0,
      "duration_ms": 27821.74015045166,
      "threshold": 0.2501371204853058
    },
    "HTML": {
      "dataset": "HTML",
      "preprocessed": true,
      "samples": 42,
      "accuracy": 0.5,
      "recall": 0.36363636363636365,
      "precision": 0.5333333333333333,
      "f1": 0.43243243243243246,
      "fpr": 0.35,
      "fnr": 0.6363636363636364,
      "auc": 0.5522727272727272,
      "confusion_matrix": {
        "tn": 13,
        "fp": 7,
        "fn": 14,
        "tp": 8
      },
      "duration_ms": 73.53067398071289,
      "threshold": 0.2501371204853058
    },
    "Overall": {
      "dataset": "Overall",
      "preprocessed": false,
      "samples": 5546,
      "accuracy": 0.9028128380815001,
      "recall": 0.9482990582356333,
      "precision": 0.9481168332052268,
      "f1": 0.948207936965504,
      "fpr": 0.7871720116618076,
      "fnr": 0.05170094176436671,
      "auc": 0.7214174486686028,
      "confusion_matrix": {
        "tn": 73,
        "fp": 270,
        "fn": 269,
        "tp": 4934
      },
      "duration_ms": 10006.440877914429,
      "threshold": 0.2501371204853058
    },
    "threshold_sweep": {
      "sweep_results": [
        {
          "threshold": 0.1,
          "fpr": 0.8658892128279884,
          "recall": 0.9746300211416491
        },
        {
          "threshold": 0.15000000000000002,
          "fpr": 0.8250728862973761,
          "recall": 0.9663655583317317
        },
        {
          "threshold": 0.20000000000000004,
          "fpr": 0.7988338192419825,
          "recall": 0.9590620795694792
        },
        {
          "threshold": 0.25000000000000006,
          "fpr": 0.7871720116618076,
          "recall": 0.9482990582356333
        },
        {
          "threshold": 0.30000000000000004,
          "fpr": 0.7696793002915452,
          "recall": 0.9438785316163751
        },
        {
          "threshold": 0.3500000000000001,
          "fpr": 0.7376093294460642,
          "recall": 0.9359984624255238
        },
        {
          "threshold": 0.40000000000000013,
          "fpr": 0.7055393586005831,
          "recall": 0.9292715740918701
        },
        {
          "threshold": 0.4500000000000001,
          "fpr": 0.6822157434402333,
          "recall": 0.9231212761868153
        },
        {
          "threshold": 0.5000000000000001,
          "fpr": 0.6618075801749271,
          "recall": 0.9181241591389583
        },
        {
          "threshold": 0.5500000000000002,
          "fpr": 0.6472303206997084,
          "recall": 0.9110128771862387
        },
        {
          "threshold": 0.6000000000000002,
          "fpr": 0.6297376093294461,
          "recall": 0.9000576590428598
        },
        {
          "threshold": 0.6500000000000001,
          "fpr": 0.6180758017492711,
          "recall": 0.8902556217566788
        },
        {
          "threshold": 0.7000000000000002,
          "fpr": 0.6064139941690962,
          "recall": 0.8808379780895638
        },
        {
          "threshold": 0.7500000000000002,
          "fpr": 0.5830903790087464,
          "recall": 0.8658466269459927
        },
        {
          "threshold": 0.8000000000000003,
          "fpr": 0.5510204081632653,
          "recall": 0.8447049778973669
        },
        {
          "threshold": 0.8500000000000003,
          "fpr": 0.5102040816326531,
          "recall": 0.8206803767057467
        },
        {
          "threshold": 0.9000000000000002,
          "fpr": 0.46938775510204084,
          "recall": 0.7772438977512973
        }
      ],
      "best_for_target_fpr": null
    }
  },
  "pass_fail_summary": [
    {
      "dataset": "SaTML",
      "passed": false,
      "message": "Recall 0.0% < 80.0%"
    },
    {
      "dataset": "deepset_benign",
      "passed": true,
      "message": "All targets met"
    },
    {
      "dataset": "deepset_injections",
      "passed": false,
      "message": "Recall 0.0% < 85.0%"
    },
    {
      "dataset": "NotInject",
      "passed": true,
      "message": "All targets met"
    },
    {
      "dataset": "LLMail",
      "passed": false,
      "message": "Recall 0.0% < 80.0%"
    },
    {
      "dataset": "HTML",
      "passed": true,
      "message": "No targets defined"
    },
    {
      "dataset": "Overall",
      "passed": false,
      "message": "FPR 78.7% > 5.0%"
    }
  ],
  "targets": {
    "deepset_benign": {
      "max_fpr": 0.05,
      "description": "deepset benign FPR"
    },
    "NotInject": {
      "max_fpr": 0.05,
      "description": "NotInject FPR"
    },
    "deepset_injections": {
      "min_recall": 0.85,
      "description": "deepset injection recall"
    },
    "SaTML": {
      "min_recall": 0.8,
      "description": "SaTML recall"
    },
    "LLMail": {
      "min_recall": 0.8,
      "description": "LLMail recall"
    },
    "Overall": {
      "max_fpr": 0.05,
      "min_recall": 0.85,
      "description": "Overall metrics"
    }
  }
}